# -*- coding: utf-8 -*-
"""
Created on Thu Jun 19 08:58:52 2025

@author: a.karabedyan
"""

NAME_APP = 'Clara'
SUB_TITLE_APP = 'классификатор активов'
NAME_DATA_FILE = 'данные_для_обучения.xlsx'
NAME_DATA_PREDICTION = 'данные_для_предсказания.xlsx'
NAME_OUTPUT_FILE = 'предсказанные_данные.xlsx'
MIN_ROWS = 1000

TEXT_INTRODUCTION = f"""# от англ. Classification-of-Resources-Assets - автоматический классификатор

## Описание
Приложение для автоматической группировки активов предприятия (основные средства, запасы, расходы и т.д.) на основе машинного обучения. Будет полезно специалистам финансово-экномических отделов, занимающихся сводными по группе компаний отчетами, когда необходимо быстро рассортировать "Прочие" позиции. Приложение использует алгоритм **ComplementNB** (Complement Naive Bayes) - специальную версию метода "наивного Байеса", оптимизированную для работы с несбалансированными данными.

### Как работает алгоритм
- Анализирует текст наименований активов
- Учитывает частоту встречаемости слов в разных группах
- Особенно эффективен когда:
  - Группы неравномерно представлены в данных
  - Есть много повторяющихся слов в наименованиях
- Автоматически адаптируется к специфике вашей терминологии

## Требования к данным
Для обучения модели подготовьте Excel-файл по образцу ниже:

| Наименование              | Группа               |
|---------------------------|----------------------|
| Станок токарный           | Машины и оборудование (кроме офисного)    |
| Автостанция (Наливная 95)            | Здания и сооружения            |
| Бычки до 6 мес.    | Биоактивы     |

Для удобства скопируйте файл в папку вместе с приложением.

**Обязательные условия:**
1. Минимум **1000 строк** в файле, но лучше больше
2. Минимум **2 разные группы** (например "Офисное оборудование" и "Производственный и хозяйственный инвентарь")
3. В каждой группе должно быть **не менее 10 наименований**

## Процесс работы

### 1. Обучение модели
1. Нажмите кнопку **"Обучить модель"**
2. Выберите Excel-файл с историческими данными
3. Дождитесь завершения обучения (до 200 тыс. строк обрабатываются как правило менее 5 минут)
4. Получите отчет по образцу ниже:
## Результаты обучения модели

### Основные метрики
✅ **Общая точность:** 87%
✅ **Средняя вероятность верного предсказания:** 89%

### Распределение по группам
| Группа               | Количество | Доля |
|-----------------------|------------|------|
| Машины и оборудование (кроме офисного)     | 45         | 45%  |
| Здания и сооружения            | 35         | 35%  |
| Биоактивы     | 20         | 20%  |

### Качество распознавания по группам
1. **Машины и оборудование (кроме офисного)**
   - Верно распознано: 43 из 45 (96%)
   - Типичные ошибки: путает с "Оборудованием" (2 случая)

2. **Материалы**
   - Верно распознано: 32 из 35 (91%)
   - Типичные ошибки: путает с "Товарами" (3 случая)

### Рекомендации
⚠️ Для улучшения точности:
- Добавьте 10-15 примеров для группы "Арендные платежи"
- Уточните формулировки для "Офисная техника" и "Оборудование"

5. Введите понятное имя модели (например: "Классификатор ОС и материалов 2024")

### 2. Получение предсказаний
1. Нажмите **"Классифицировать по группам"**
2. Выберите раннее обученную модель из списка
3. Укажите файл с новыми наименованиями (та же структура, но без столбца "Группа")
4. Получите результат в новом Excel-файле:

| Наименование              | Предсказанная группа | Вероятность |
|---------------------------|----------------------|-------------|
| Кресло офисное            | Офисное оборудование    | 89%         |
| Весы автомобильные           | Машины и оборудование (кроме офисного)            | 93%         |

## Интерпретация результатов
- **Вероятность >80%** - высокая достоверность
- **Вероятность 60-80%** - рекомендуется проверка
- **Вероятность <60%** - модель не уверена, требуется ручная классификация

## Советы
- Для улучшения точности добавляйте в обучение больше примеров
- Используйте единообразные формулировки в наименованиях
- Обновляйте модель при появлении новых типов активов
"""

TEXT_GENERAL = """Нажмите Ctrl+o или соответствующую кнопку внизу, чтобы обучить модель. На данном этапе нужно выбрать файл excel с таблицей с заполненными столбцами:
    name - наименования актива;
    group - группа, сохранить и закрыть файл.
После обучения модель будет сохранена для дальнейшего использования и доступна для выбора в окне справа. Выберете нужную модель перед тем, как классифицировать новые активы.
/ТРЕБОВАНИЯ К ОБУЧАЮЩЕЙ ВЫБОРКЕ/
Нажмите Ctrl+r или соответствующую кнопку внизу, чтобы классифицировать активы. На данном этапе нужно выбрать файл excel с таблицей с заполненным столбцом:
    name - наименования актива;
После обработки файл с классифицированными активами {NAME_OUTPUT_FILE} будет доступен в папке, из которой запущен {NAME_APP}.

Выбранная модель: {model}

"""

TEXT_ALL_PROCESSED_FILES = """{NAME_APP} обработал все файлы Excel в указанной папке.

"""+TEXT_GENERAL


TEXT_ERR_FILES_EXCEL = """Извините, но {NAME_APP} не нашел в указанной папке файлы Excel.

"""+TEXT_GENERAL


TEXT_APP_EXCEL_NOT_FIND = """Ошибка при загрузке {NAME_OUTPUT_FILE}: Не найдено приложение для работы с Excel-файлами.
Описание ошибки: {error_app_xls}.
Убедитесь, что Excel установлен и нажмите Ctrl+r, чтобы сформировать и открыть для редактирования {NAME_OUTPUT_FILE}

"""+TEXT_GENERAL


TEXT_ERR_NO_PROCESSED_FILES = """Извините, но {NAME_APP} не смог обработать файлы. Убедитесь, что в обрабатываемых файлах существует лист с именем {model}.

"""+TEXT_GENERAL


TEXT_ERR_NOT_ALL_PROCESSED_FILES = """Обработка завершена частично. {NAME_APP} не смог обработать все файлы. Убедитесь, что в обрабатываемых файлах:
{missing_files}
существует листы с именами {model}.

"""+TEXT_GENERAL


TEXT_ERR_PERMISSION = """Нет доступа к {NAME_OUTPUT_FILE}. Пожалуйста, закройте данный файл.

"""+TEXT_GENERAL


TEXT_ERR_FILE_NOT_FOUND = """Не найден {NAME_OUTPUT_FILE}. Повторите операцию, нажав Ctrl+r или соответствующую кнопку внизу.

"""+TEXT_GENERAL


TEXT_UNKNOW_ERR = """Извините, произошла неучтенная ошибка: {text_err}.
Перезапустите приложение и попробуйте снова. Если ошибка повторяется, свяжитесь в телеграм @kaetosh"""

TEXT_GENERATING_LIST_SHEETS = 'Идет чтение файлов и формирование списка листов, в случае больших файлов обработка может потребовать продолжительное время.'

TEXT_AGGREGATION_PROCESS = 'Собираем данные с выбранных листов каждого файла...'

TEXT_CONCAT_PROCESS = 'Объединяем данные в общий массив...'

TEXT_LOAD_FILE_XLS = 'Выгружаем сводные данные в excel файл...'

TEXT_OPEN_FILE_XLS = f'Открываем {NAME_OUTPUT_FILE}...'

TEXT_NOT_SELECT_DIR = """Не выбрана папка с файлами для обработки.

"""+TEXT_GENERAL

TEXT_ERR_NO_SELECT_SHEETS = """Не выбраны листы для обработки.

"""+TEXT_GENERAL