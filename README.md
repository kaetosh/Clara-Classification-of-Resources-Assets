# Clara — Classification-of-Resources-Assets

## Описание

Clara — это приложение для автоматической классификации небольших текстов (например, наименований активов предприятия) по группам: основные средства, запасы, расходы и др.  
Полезно специалистам финансово-экономических служб, работающим со сводными отчетами по группе компаний, когда нужно быстро и точно распределить позиции, например, «Прочие».  
В основе — алгоритм Complement Naive Bayes, оптимизированный для работы с несбалансированными данными.

---

## Как работает алгоритм

- **Анализ текста**: разбивает наименования на слова (токены).  
- **Подсчёт частот**: считает, как часто слова встречаются в каждой группе с учётом распределения по другим классам (комплементарный подход).  
- **Обработка несбалансированных данных**: хорошо работает, когда группы представлены неравномерно.  
- **Фильтрация часто встречающихся слов**: снижает влияние общих слов, не несущих различительной информации.  
- **Адаптация к терминологии**: обучается на ваших данных, подстраиваясь под специфику.

---

## Требования к данным

Для обучения модели нужен Excel-файл с уже классифицированными данными (таблица на первом листе):

| Наименование              | Группа                                |
|---------------------------|-------------------------------------|
| Станок токарный           | Машины и оборудование (кроме офисного) |
| Автостанция (Наливная 95) | Здания и сооружения                  |
| Бычки до 6 мес.           | Биоактивы                          |
| ...                       | ...                                 |

**Обязательные условия:**

1. Не менее **1000 записей**, лучше от **10 000¹**  
2. Минимум **2 разные группы**  
3. В каждой группе — не менее 10 наименований

¹ На такой выборке достигается около 90% точности на данных по основным средствам.

Файл скопируйте в папку с приложением.

---

## Процесс работы

### 1. Обучение модели

1. Нажмите **"Обучить модель"**  
2. Выберите Excel-файл с обучающими данными  
3. Дождитесь окончания (до 200 000 строк — обычно менее 5 минут)  
4. Получите отчёт по обученной модели  
5. Введите имя модели и сохраните (например, "Классификатор основных средств")

### 2. Классификация новых данных

Подготовьте Excel-файл с наименованиями (таблица на первом листе):

| Наименование              |
|---------------------------|
| Блок подсобных помещений  |
| Ветсанпропускник, Лит. Ц9 |
| Haval Jolion, Г585ТА770   |
| ...                       |

Скопируйте файл в папку с приложением.

1. Нажмите **"Классифицировать"**  
2. Выберите файл с новыми наименованиями  
3. Выберите ранее обученную модель  
4. Получите классификацию в Excel-файле

---
## Установка

1. Скопируйте репозиторий [https://github.com/kaetosh/ExcelAggregator-v2.git](https://github.com/kaetosh/ClsTextual.git)
2. Установите необходимые библиотеки ```pip install -r requirements.txt```
3. Сформируйте exe-файл для удобного использования приложения ```pyinstaller --onefile --windowed --add-data "CascadiaCode.ttf;." main.py```.
4. Запустите exe-файл main.exe из папки dist
---

## Рекомендации

- Проверьте качество размеченных данных для обучения — ошибки в обучении влияют на точность.  
- После обучения в папке с приложением сохраняются файлы `.joblib` с моделями. Не удаляйте и не перемещайте их, если планируете использовать модели. Устаревшие модели можно удалить.  
- Следите за показателями точности и средней вероятности предсказания. Если ниже 80%, рекомендуется обучить модель на более крупном и разнообразном наборе данных (от 10 000 позиций).  
- Используйте одну и ту же модель для обучения и классификации по схожим данным. Например, модель, обученная на основных средствах, не подходит для запасов.  
- Все Excel-файлы — и для обучения, и для классификации — помещайте в папку с приложением. Результаты классификации сохраняются там же.  
- Модель — помощник, а не замена эксперту. Автоматические предсказания могут быть неточными, если наименования сильно отличаются от обучающих данных или содержат неоднозначности. Регулярно проверяйте и при необходимости корректируйте данные и модель.

---

## Контакты и поддержка

Если у вас возникли вопросы или предложения, пожалуйста, 
e-mail: me@karabedyan.ru
telegram: @kaetosh


---

Спасибо за использование Clara!
